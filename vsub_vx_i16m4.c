/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
  181, 219, 62, 38, 80, 106, 115, 116, 61, 88, 63, 36, 78, 112, 114, 149, 89, 19, 16, 31, 254, 179, 135, 140, 107, 207, 222, 138, 117, 13, 27, 94, 196, 167, 45, 67, 121, 45, 119, 113, 11, 210, 185, 53, 75, 94, 186, 101, 172, 30, 66, 175, 97, 132, 157, 66, 165, 187, 234, 185, 215, 95, 241, 205
  };
  const int *in1 = &data1[0];
    int data2[] = {
  220, 196, 211, 70, 159, 112, 76, 157, 130, 197, 29, 155, 228, 198, 58, 107, 215, 43, 170, 233, 152, 162, 225, 143, 212, 159, 58, 178, 232, 51, 61, 28, 77, 102, 81, 54, 155, 126, 213, 51, 184, 146, 6, 225, 170, 43, 119, 221, 222, 63, 18, 48, 196, 160, 55, 173, 92, 91, 187, 53, 212, 127, 116, 241
  const int *in2 = &data2[0];
  int out_data[64];
  int *out = &out_data[0];
  for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
    vint16m4_t out = __riscv_vsub_vx_i16m4 (data1, data2);
    in1 += Q_element;
    out += Q_element;
  }
  int golden[] = {
  -39, 23, -149, -32, -79, -6, 39, -41, -69, -109, 34, -119, -150, -86, 56, 42, -126, -24, -154, -202, 102, 17, -90, -3, -105, 48, 164, -40, -115, -38, -34, 66, 119, 65, -36, 13, -34, -81, -94, 62, -173, 64, 179, -172, -95, 51, 67, -120, -50, -33, 48, 127, -99, -28, 102, -107, 73, 96, 47, 132, 3, -32, 125, -36
  };
  int fail = 0;
  for (int i = 0; i < 64; i++)
     if (golden0[i] != out0_data[i]) {
       printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
       fail++;
     }
  if (fail) {
    return 1;
  } else {
    return 0;
  }
}
