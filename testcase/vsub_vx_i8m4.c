/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
    83, 137, 166, 116, 175, 81, 118, 83, 250, 226, 6, 82, 187, 81, 211, 112, 157, 3, 151, 215, 254, 4, 133, 166, 159, 69, 125, 40, 129, 111, 43, 104, 41, 225, 88, 30, 168, 109, 215, 183, 154, 123, 135, 115, 41, 241, 12, 196, 216, 184, 164, 90, 107, 111, 199, 67, 17, 200, 253, 214, 32, 134, 5, 42
    };
    const int *in1 = &data1[0];
    int data2[] = {
    87, 224, 80, 143, 131, 100, 232, 222, 131, 218, 33, 177, 153, 194, 135, 33, 20, 112, 247, 197, 204, 139, 115, 168, 64, 137, 197, 62, 121, 189, 153, 19, 64, 244, 0, 64, 152, 248, 251, 115, 131, 253, 190, 112, 216, 222, 23, 153, 10, 82, 14, 96, 172, 88, 47, 229, 9, 181, 252, 130, 229, 133, 129, 151
    };
    const int *in2 = &data2[0];
    int out_data[64];
    int *out = &out_data[0];
    for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
        vint8m4_t out = __riscv_vsub_vx_i8m4 (data1, data2, 64);
        in1 += Q_element;
        in2 += Q_element;
        out += Q_element;
  }
   int golden[] = {
   -4, -87, 86, -27, 44, -19, -114, -139, 119, 8, -27, -95, 34, -113, 76, 79, 137, -109, -96, 18, 50, -135, 18, -2, 95, -68, -72, -22, 8, -78, -110, 85, -23, -19, 88, -34, 16, -139, -36, 68, 23, -130, -55, 3, -175, 19, -11, 43, 206, 102, 150, -6, -65, 23, 152, -162, 8, 19, 1, 84, -197, 1, -124, -109
   };
    int fail = 0;
    for (int i = 0; i < 64; i++)
        if (golden0[i] != out0_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
            fail++;
            }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
