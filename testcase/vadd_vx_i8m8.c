/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    vint8m8_t data1[] = {
    229, 23, 232, 241, 236, 0, 94, 148, 250, 29, 79, 180, 100, 146, 97, 18, 47, 2, 43, 240, 145, 66, 93, 175, 226, 161, 177, 70, 57, 8, 100, 35, 46, 54, 147, 166, 238, 223, 133, 194, 187, 182, 255, 251, 106, 42, 9, 122, 17, 240, 165, 200, 181, 172, 52, 20, 31, 19, 139, 129, 10, 222, 109, 24, 87, 79, 241, 47, 247, 101, 253, 115, 200, 46, 24, 17, 240, 9, 102, 78, 77, 16, 117, 57, 46, 86, 174, 233, 216, 5, 164, 214, 86, 104, 117, 50, 91, 206, 234, 88, 107, 201, 74, 186, 169, 111, 132, 173, 101, 188, 59, 203, 219, 78, 161, 23, 100, 232, 50, 180, 190, 78, 108, 139, 214, 30, 162, 104
    };
    const vint8m8_t *in1 = &data1[0];
    vint8m8_t data2[] = {
    175, 238, 103, 181, 202, 216, 67, 216, 56, 248, 183, 240, 86, 146, 178, 220, 119, 170, 11, 24, 4, 132, 230, 226, 170, 39, 95, 31, 22, 229, 247, 37, 74, 142, 232, 124, 7, 66, 175, 152, 124, 34, 218, 48, 93, 59, 100, 239, 68, 127, 70, 115, 192, 101, 131, 168, 165, 220, 100, 173, 250, 125, 189, 178, 169, 198, 48, 76, 241, 215, 252, 185, 184, 93, 176, 90, 252, 148, 63, 229, 93, 79, 167, 14, 46, 72, 55, 81, 94, 178, 231, 248, 236, 238, 151, 241, 43, 249, 231, 151, 241, 207, 18, 86, 139, 218, 61, 43, 68, 74, 52, 32, 87, 106, 143, 115, 245, 135, 74, 43, 24, 232, 147, 226, 189, 120, 60, 106
    };
    const vint8m8_t *in2 = &data2[0];
    vint8m8_t out_data[64];
    vint8m8_t *out = &out_data[0];
    for (int n = 128, Q_element = 8;n >= 0; n -= Q_element) {
        vint8m8_t out = __riscv_vadd_vx_i8m8 (data1, data2, 64);
        in1 += Q_element;
        in2 += Q_element;
        out += Q_element;
      }
    vint8m8_t golden[] = {
    404, 261, 335, 422, 438, 216, 161, 364, 306, 277, 262, 420, 186, 292, 275, 238, 166, 172, 54, 264, 149, 198, 323, 401, 396, 200, 272, 101, 79, 237, 347, 72, 120, 196, 379, 290, 245, 289, 308, 346, 311, 216, 473, 299, 199, 101, 109, 361, 85, 367, 235, 315, 373, 273, 183, 188, 196, 239, 239, 302, 260, 347, 298, 202, 256, 277, 289, 123, 488, 316, 505, 300, 384, 139, 200, 107, 492, 157, 165, 307, 170, 95, 284, 71, 92, 158, 229, 314, 310, 183, 395, 462, 322, 342, 268, 291, 134, 455, 465, 239, 348, 408, 92, 272, 308, 329, 193, 216, 169, 262, 111, 235, 306, 184, 304, 138, 345, 367, 124, 223, 214, 310, 255, 365, 403, 150, 222, 210
    };
    int fail = 0;
    for (int i = 0; i < 128; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
