/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    -3443341918050349783, 7022377035560563313, 2300390982456662763, 920104534853066365, -5097532195662694294, -3593436333389189287, 4842728339254120479, 9183576931472795480, -5734542708218817206, -80729209588649127, -7600289698465594785, 1628236467068142315, -6625331482375350493, 9002473065034219734, 1828578881463281387, -4826062713427046030
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    934514973072728364, -1149773377178437131, -912374821386321293, -3224980327783746949, 3540975108987646742, -2629692377569002850, -6782469389827241786, 748525217966896978, 2855606708083789184, 1939785568970087236, 1897271181923403333, -186322777948568879, -7677750806132345588, -2350967525715190087, -3739421124846121303, -3662784113242490474
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m8(avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m8_t data1_v = __riscv_vle64_v_i64m8 (in1, vl);
    vint64m8_t data2_v = __riscv_vle64_v_i64m8 (in2, vl);
    vint64m8_t out_v = __riscv_vle64_v_i64m8 (out, vl);
    for (size_t n = 0; n < vl; n++) {
		out = __riscv_vadd_vv_i64m8(op1, op2, vl);
        void __riscv_vse64_v_i64m8 (int64_t *out, vint64m8_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    15937917128731930197, 5872603658382126182, 1388016161070341470, 16141868280778871032, 16890186987034504064, 12223615362751359479, 16507003023136430309, 9932102149439692458, 15567808073574523594, 1859056359381438109, 12743725557167360164, 1441913689119573436, 4143661785201855535, 6651505539319029647, 16535901830326711700, 9957897247040015112
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    -1044990903728801721, -1693140896228448539, -8439283398978620032, -5172670269313480046, -3771868361023243203, 3952408533949824886, 1258869544543478454, 436037467924154937, 3706313627678867576, 2624102377726961114, 8329188404737754782, -1890949580642471476, 8899535015762552696, -1246816956306561434, -5604740860850719978, -3890490055824366607
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    -2767309825740437473, 1775277500150612159, -8994067864981115568, -1381908510016573444, -8680848334314890019, 7263705375545451547, 8303736328242752458, 5425515421320971666, 974073574377022698, 7074083647824726872, -6955644222888284372, 6058454765307268815, -7072451176420163330, -7737834681984350453, 2859649491652089885, 2612425137080172689
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m8(avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m8_t data1_v = __riscv_vle64_v_i64m8 (in1, vl);
    vint64m8_t data2_v = __riscv_vle64_v_i64m8 (in2, vl);
    vint64m8_t out_v = __riscv_vle64_v_i64m8 (out, vl);
    for (size_t n = 0; n < vl; n++) {
        void __riscv_vse64_v_i64m8 (int64_t *out, vint64m8_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    14634443344240312422, 82136603922163620, 1013392809749816016, 11892165294379498126, 5994027378371418394, 11216113909495276433, 9562605872786230912, 5861552889245126603, 4680387202055890274, 9698186025551687986, 1373544181849470410, 4167505184664797339, 1827083839342389366, 9462092435418639729, 15701652704510921523, 17168679154965357698
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
