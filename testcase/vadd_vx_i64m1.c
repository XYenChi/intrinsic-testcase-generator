/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    3909275533822181556, 436698759768844194, -4140624361986855691, 3407402561253813671, -6492557800633984169, 2669113545533890591, -188100448849383200, 2328288517132900399, 5189219604467683860, 1138944265910535796, -4341140436657696969, 3352418252480733558, 2775726834803765121, 6640580801393495894, 5106491001249116344, 75159222789622951
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    8577686014490723033, -6893141858881446678, -7636558458615840251, -6921653510676912448, 2323586961739337881, 5909536554281396349, -3872281398519648297, -3238055969957183418, 1147106513967298656, -6820269973534644011, 5009211853309165813, -6950970771583343589, 8996606328596438649, 1244633690848485181, 3565414079826017311, -7571882816477294094
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m1(avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m1_t data1_v = __riscv_vle64_v_i64m1 (in1, vl);
    vint64m1_t data2_v = __riscv_vle64_v_i64m1 (in2, vl);
    vint64m1_t out_v = __riscv_vle64_v_i64m1 (out, vl);
    for (size_t n = 0; n < vl; n++) {
		out = __riscv_vadd_vx_i64m1(op1, op2, vl);
        void __riscv_vse64_v_i64m1 (int64_t *out, vint64m1_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    12486961548312904589, 11990300974596949132, 6669561253106855674, 14932493124286452839, 14277773234814905328, 8578650099815286940, 14386362226340520119, 17536976620885268597, 6336326118434982516, 12765418366085443401, 668071416651468844, 14848191554606941585, 11772333163400203770, 7885214492241981075, 8671905081075133655, 10950020480021880473
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    -7395497217244164703, 6688954505236285279, 901981269535207799, 2663411720454568948, -3807998478802942712, -7976924014094372795, -2546060232281976775, 836000913785420480, -9053096525555486426, -5117734276527080765, 1108596018385340889, 8287505135774469970, 4714086233274858863, 8437095834308181156, -1684775570142394521, -2480641382808372033
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    7295973978592270178, -4803025282040787135, -9001454482420647224, -2525390064483653951, -845569824031961393, -4313193779190346549, -5614350073648593152, -8070774597216326356, -144856268315069917, 7461847594840042429, 8479367030953527696, 5008102607102478738, 3602364845314048638, 3936688180204350751, -898702746813235289, -1182902040014503860
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m1(avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m1_t data1_v = __riscv_vle64_v_i64m1 (in1, vl);
    vint64m1_t data2_v = __riscv_vle64_v_i64m1 (in2, vl);
    vint64m1_t out_v = __riscv_vle64_v_i64m1 (out, vl);
    for (size_t n = 0; n < vl; n++) {
        void __riscv_vse64_v_i64m1 (int64_t *out, vint64m1_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    18347220835057657091, 1885929223195498144, 10347270860824112191, 138021655970914997, 13793175770874647511, 6156626280424832272, 10286333767778981689, 11211970390278645740, 9248791279838995273, 2344113318312961664, 9587963049338868585, 13295607742876948708, 8316451078588907501, 12373784014512531907, 15863265756753921806, 14783200650886675723
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
