/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    11259227319208428164, 6713763398678688592, 11753781894334526472, 7738957258958706905, 14400754871184148088, 2389679459807223062, 6498123531875392573, 8457321696642985502, 16500427652150053340, 9199375046545701189, 11445520801887482846, 14353044733851870171, 15797120327977701801, 10075248551313400172, 4082728387412304761, 7395185341499634984
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    16269875661703104716, 11661731920215078734, 6883297009243782120, 10686310855500888334, 2966945550170080778, 10899184707464187929, 15371128076345452999, 13082206808100278207, 8959054847325069841, 14825380720309892, 18228446603601846056, 8801124297307798565, 16383071299006405965, 13109253380371366180, 992433497445520222, 17736781844551641994
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = vsetvl_e64m8(size_t avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m8_t data1_v = __riscv_vle64_v_i64m8 (*in1, vl);
    vint64m8_t data2_v = __riscv_vle64_v_i64m8 (*in2, size_t vl);
    vint64m8_t out_v = __riscv_vle64_v_i64m8 (*out, size_t vl);
    for (size_t n = 0; n < vl; n++) {
        void vint64m8_t __riscv_vse64_v_i64 (int64m8_t *out, out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    16269875661703104716, 11661731920215078734, 6883297009243782120, 10686310855500888334, 2966945550170080778, 10899184707464187929, 15371128076345452999, 13082206808100278207, 8959054847325069841, 14825380720309892, 18228446603601846056, 8801124297307798565, 16383071299006405965, 13109253380371366180, 992433497445520222, 17736781844551641994
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
