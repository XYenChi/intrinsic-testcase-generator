/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
    157, 108, 37, 221, 12, 147, 182, 174, 180, 21, 70, 178, 245, 80, 75, 5, 79, 90, 173, 149, 251, 178, 173, 235, 151, 144, 104, 88, 52, 189, 162, 15, 4, 136, 242, 178, 252, 4, 66, 21, 233, 240, 221, 50, 213, 102, 2, 12, 226, 52, 126, 5, 255, 231, 9, 74, 80, 26, 71, 44, 42, 10, 84, 96
    };
    const int *in1 = &data1[0];
    int data2[] = {
    198, 142, 182, 250, 128, 200, 27, 68, 114, 34, 152, 77, 32, 47, 190, 144, 69, 237, 170, 22, 236, 203, 63, 38, 72, 159, 214, 87, 104, 91, 197, 134, 23, 4, 249, 189, 254, 247, 87, 131, 80, 201, 206, 59, 147, 51, 71, 54, 127, 87, 223, 12, 184, 226, 91, 106, 5, 61, 254, 151, 231, 24, 98, 207
    };
    const int *in2 = &data2[0];
    int out_data[64];
    int *out = &out_data[0];
    for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
        vint16m2_t out = __riscv_vsub_vx_i16m2 (data1, data2, 64);
        in1 += Q_element;
        in2 += Q_element;
        out += Q_element;
  }
   int golden[] = {
   -41, -34, -145, -29, -116, -53, 155, 106, 66, -13, -82, 101, 213, 33, -115, -139, 10, -147, 3, 127, 15, -25, 110, 197, 79, -15, -110, 1, -52, 98, -35, -119, -19, 132, -7, -11, -2, -243, -21, -110, 153, 39, 15, -9, 66, 51, -69, -42, 99, -35, -97, -7, 71, 5, -82, -32, 75, -35, -183, -107, -189, -14, -14, -111
   };
    int fail = 0;
    for (int i = 0; i < 64; i++)
        if (golden0[i] != out0_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
            fail++;
            }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
