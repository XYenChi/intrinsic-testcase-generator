/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    4559916119913228570, -6064009204506232808, -7411201961174595857, 8358282965284936474, 1130988498979178983, 4148326266023380760, 1229283341436699985, 7625265906543888611, 7972924637997240929, -2211430835896048007, 8493825667387314859, -3131995149704007083, 8716624470430600162, -706041283806569615, -8382663577707227948, 3393023946417665696
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    -1590273244459773182, 9081266801702107192, -579809469099097115, 1519517454281989663, -3624140291794398808, -333396984816806527, 562705869216717886, -8088720222750107228, 6472332453864008584, 5139673451228966867, -7029315204414374855, 5901243084040255452, 1793585089354806301, 8365419483905904504, 4376926657447089562, 7938137915958774830
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m8(avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m8_t data1_v = __riscv_vle64_v_i64m8 (in1, vl);
    vint64m8_t data2_v = __riscv_vle64_v_i64m8 (in2, vl);
    vint64m8_t out_v = __riscv_vle64_v_i64m8 (out, vl);
    for (size_t n = 0; n < vl; n++) {
		out = __riscv_vadd_vx_i64m8(op1, op2, vl);
        void __riscv_vse64_v_i64m8 (int64_t *out, vint64m8_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    2969642875453455388, 3017257597195874384, 10455732643435858644, 9877800419566926137, 15953592280894331791, 3814929281206574233, 1791989210653417871, 17983289757503332999, 14445257091861249513, 2928242615332918860, 1464510462972940004, 2769247934336248369, 10510209559785406463, 7659378200099334889, 14441007153449413230, 11331161862376440526
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    2240433254282879709, 2276512039766884302, 4039803200323059609, 425866753081702142, -2656824107783389727, -5379737908711482800, -5464176269789471519, 135130320015071938, -4547239817200333741, -1455100649648162711, 8221605453041145267, -6849943081823798914, -3431120271776258756, -2594818670775137585, 4394179868873559343, -4663535790314777464
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    8622211702787122957, -6808447488302170116, 673457778902353599, -2902372424634208072, -811631744828546886, -2581699169654457634, -7357886643658851831, -6759659335179444021, -6895087417086618006, 3640940076913438352, -6811055531481871499, -6343751333871506836, 3391690942512336232, 6740675792125609493, 6939199365134990466, 8923301502649376247
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m8(avl);
    const int64_t out_data[16];
    const int64_t *out = &out_data[0];
    vint64m8_t data1_v = __riscv_vle64_v_i64m8 (in1, vl);
    vint64m8_t data2_v = __riscv_vle64_v_i64m8 (in2, vl);
    vint64m8_t out_v = __riscv_vle64_v_i64m8 (out, vl);
    for (size_t n = 0; n < vl; n++) {
        void __riscv_vse64_v_i64m8 (int64_t *out, vint64m8_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    int64_t golden[] = {
    10862644957070002666, 13914808625174265802, 4713260979225413208, 15970238402157045686, 14978288221097615003, 10485306995343611182, 5624681160261228266, 11822215058545179533, 7004416839422599869, 2185839427265275641, 1410549921559273768, 5253049658014245866, 18407314744445629092, 4145857121350471908, 11333379234008549809, 4259765712334598783
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
