/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const uint64_t data1[] = {
    7945473208797467447, 8853870773798812875, 8081030715824607908, 11881847358065197624, 2298177957457119994, 4921029100371338777, 5467748816341147329, 3822090964094243948, 1874500334993435484, 5770566757131925847, 2679069788704177577, 4813813066120901737, 10680583791633576268, 12326481049874922989, 1538998478599910114, 2640170007759311831
    };
    const uint64_t *in1 = &data1[0];
    const uint64_t data2[] = {
    2293145869903787481, 6747481348201094539, 6966987256043645439, 1681679242648863857, 16820613196642088647, 9896834595204242927, 16818198106060041975, 7315849639669755410, 10656223860721960418, 14357875275163528917, 4380021145957603764, 17840093941741580156, 41505181320232625, 2904254708959506571, 17186030925904447800, 12368907318858097646
    };
    const uint64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m8(avl);
    const uint64_t out_data[16];
    const uint64_t *out = &out_data[0];
    vuint64m8_t data1_v = __riscv_vle64_v_u64m8 (in1, vl);
    vuint64m8_t data2_v = __riscv_vle64_v_u64m8 (in2, vl);
    vuint64m8_t out_v = __riscv_vle64_v_u64m8 (out, vl);
    for (size_t n = 0; n < vl; n++) {
		out = __riscv_vadd_vv_u64m8(op1, op2, vl);
        void __riscv_vse64_v_u64m8 (uint64_t *out, vuint64m8_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    uint64_t golden[] = {
    10238619078701254928, 15601352121999907414, 15048017971868253347, 13563526600714061481, 672047080389657025, 14817863695575581704, 3839202848691637688, 11137940603763999358, 12530724195715395902, 1681697958585903148, 7059090934661781341, 4207162934152930277, 10722088972953808893, 15230735758834429560, 278285330794806298, 15009077326617409477
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const uint64_t data1[] = {
    17490238897941588308, 13253089161884678755, 48130861936979498, 12828941771775828947, 8280856615272549608, 11324239969185469164, 6485429333093124171, 13796359527937663840, 14475081593718730894, 8132100392978863614, 7123446686388809739, 17542515715576874021, 9480808647045283441, 12306937255674973384, 17559558998736710852, 6198453230962470101
    };
    const uint64_t *in1 = &data1[0];
    const uint64_t data2[] = {
    1064160409539104004, 7564302843782849547, 3269944814618378910, 15746321601536784137, 1145329992505440864, 7559838252733760036, 14011809960927494940, 11446776033707288922, 3344714485844076179, 7231878371012672064, 6501654792556292143, 16070598432106983168, 9453666814525434675, 3050189529576240432, 8568209033477681899, 13135346832151058130
    };
    const uint64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m8(avl);
    const uint64_t out_data[16];
    const uint64_t *out = &out_data[0];
    vuint64m8_t data1_v = __riscv_vle64_v_u64m8 (in1, vl);
    vuint64m8_t data2_v = __riscv_vle64_v_u64m8 (in2, vl);
    vuint64m8_t out_v = __riscv_vle64_v_u64m8 (out, vl);
    for (size_t n = 0; n < vl; n++) {
        void __riscv_vse64_v_u64m8 (uint64_t *out, vuint64m8_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
      }
    uint64_t golden[] = {
    107655233771140696, 2370647931957976686, 3318075676555358408, 10128519299603061468, 9426186607777990472, 437334148209677584, 2050495220311067495, 6796391487935401146, 17819796079562807073, 15363978763991535678, 13625101478945101882, 15166370073974305573, 487731387861166500, 15357126785251213816, 7681023958504841135, 887055989403976615
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
