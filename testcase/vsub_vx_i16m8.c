/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
    63, 156, 125, 217, 177, 238, 153, 17, 169, 38, 240, 166, 133, 114, 28, 127, 206, 55, 10, 117, 199, 177, 58, 27, 155, 3, 213, 194, 239, 29, 232, 66, 163, 235, 17, 78, 222, 51, 250, 135, 82, 156, 229, 68, 99, 30, 36, 83, 64, 16, 227, 253, 10, 196, 245, 230, 36, 219, 239, 178, 43, 233, 144, 124
    };
    const int *in1 = &data1[0];
    int data2[] = {
    243, 37, 138, 29, 11, 233, 91, 55, 85, 121, 50, 238, 217, 159, 140, 221, 96, 32, 255, 134, 20, 213, 247, 93, 150, 147, 54, 25, 131, 26, 137, 87, 191, 196, 210, 134, 170, 59, 63, 244, 218, 29, 129, 229, 94, 161, 151, 238, 130, 226, 250, 112, 162, 216, 17, 245, 221, 91, 17, 85, 154, 133, 103, 220
    };
    const int *in2 = &data2[0];
    int out_data[64];
    int *out = &out_data[0];
    for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
        vint16m8_t out = __riscv_vsub_vx_i16m8 (data1, data2, 64);
        in1 += Q_element;
        in2 += Q_element;
        out += Q_element;
  }
   int golden[] = {
   -180, 119, -13, 188, 166, 5, 62, -38, 84, -83, 190, -72, -84, -45, -112, -94, 110, 23, -245, -17, 179, -36, -189, -66, 5, -144, 159, 169, 108, 3, 95, -21, -28, 39, -193, -56, 52, -8, 187, -109, -136, 127, 100, -161, 5, -131, -115, -155, -66, -210, -23, 141, -152, -20, 228, -15, -185, 128, 222, 93, -111, 100, 41, -96
   };
    int fail = 0;
    for (int i = 0; i < 64; i++)
        if (golden0[i] != out0_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
            fail++;
            }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
