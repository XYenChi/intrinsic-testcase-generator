/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2 -w" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    const int64_t data1[] = {
    4364534494848378543, 6979857684859098878, 3731296071182301716, -568108381366210994, 5152687378930786102, 22892936950662590, 1250142558095739277, 256223528807004035, -5506101372909137921, 5266140605926294666, -5010326277463661100, -809512101627653389, -3505752845117095326, -2613970710409053736, -4083768267460764218, 7680880589922999337
    };
    const int64_t *in1 = &data1[0];
    const int64_t data2[] = {
    -4167567917659187112, -3805611729965895630, 6510482432711014640, -428053289879590556, -7788928845251385510, 5927436013413248200, 3356385612016513420, 8501059678458090497, -1996006874193706745, 3669049141762155586, 2042421271211625933, 7937844775583029589, 8518561148789459425, -3564856335226377694, 3203492230160585184, 686217419213751118
    };
    const int64_t *in2 = &data2[0];
    size_t avl = 64;
    size_t vl = __riscv_vsetvl_e64m2(avl);
    bool32_t masked[] = {
    0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0
    };
    const bool32_t *mask = &masked[0];
    vint64m2_t data1_v = __riscv_vle64_v_i64m2 (in1, vl);
    vint64m2_t data2_v = __riscv_vle64_v_i64m2 (in2, vl);
    vint64m2_t out_v = __riscv_vle64_v_i64m2 (out, vl);
    for (size_t n = 0; n < vl; n++) {
        void __riscv_vse64_v_i64m2 (int64_t *out, vint64m2_t out_v, size_t vl);
        in1 += 8;
        in2 += 8;
        out += 8;
        mask += 8;
      }
    int64_t golden[] = {
    196966577189191431, 3174245954893203248, 10241778503893316356, -996161671245801549, -2636241466320599407, 5950328950363910790, 4606528170112252698, 8757283207265094532, -7502108247102844665, 8935189747688450252, -2967905006252035166, 7128332673955376201, 5012808303672364099, -6178827045635431430, -880276037300179033, 8367098009136750455
    };
    int fail = 0;
    for (int i = 0; i < 16; i++){
        if (golden[i] != out_data[i]) {
            printf ("idx=%d golden=%d out=%d\n", i, golden[i], out_data[i]);
            fail++;
            }
        }
    if (fail) {
        return 1;
    } else {
        return 0;
    }
}
