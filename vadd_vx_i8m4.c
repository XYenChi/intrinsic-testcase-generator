/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
  245, 62, 155, 40, 121, 117, 10, 45, 86, 62, 236, 62, 116, 154, 145, 219, 34, 36, 213, 223, 218, 251, 185, 243, 153, 243, 206, 93, 214, 46, 124, 43, 174, 52, 135, 67, 92, 114, 79, 126, 58, 172, 64, 105, 44, 113, 115, 108, 149, 204, 174, 147, 135, 222, 245, 190, 28, 237, 163, 205, 137, 235, 69, 254
  };
  const int *in1 = &data1[0];
    int data2[] = {
  44, 7, 107, 239, 37, 75, 137, 14, 25, 6, 7, 144, 84, 158, 36, 110, 200, 250, 121, 38, 228, 113, 34, 113, 255, 162, 87, 11, 41, 39, 219, 15, 51, 79, 199, 154, 9, 86, 102, 66, 233, 180, 67, 188, 223, 154, 153, 236, 245, 66, 78, 163, 47, 227, 148, 4, 167, 84, 29, 220, 170, 211, 215, 241
  const int *in2 = &data2[0];
  int out_data[64];
  int *out = &out_data[0];
  for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
    vint8m4_t out = __riscv_vadd_vx_i8m4 (data1, data2);
    in1 += Q_element;
    out += Q_element;
  }
  int golden[] = {
  289, 69, 262, 279, 158, 192, 147, 59, 111, 68, 243, 206, 200, 312, 181, 329, 234, 286, 334, 261, 446, 364, 219, 356, 408, 405, 293, 104, 255, 85, 343, 58, 225, 131, 334, 221, 101, 200, 181, 192, 291, 352, 131, 293, 267, 267, 268, 344, 394, 270, 252, 310, 182, 449, 393, 194, 195, 321, 192, 425, 307, 446, 284, 495
  };
  int fail = 0;
  for (int i = 0; i < 64; i++)
     if (golden0[i] != out0_data[i]) {
       printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
       fail++;
     }
  if (fail) {
    return 1;
  } else {
    return 0;
  }
}
