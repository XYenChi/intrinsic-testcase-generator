/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
  201, 83, 138, 241, 68, 245, 129, 242, 236, 104, 228, 18, 46, 213, 191, 101, 171, 191, 203, 8, 192, 18, 232, 176, 155, 129, 147, 79, 127, 188, 117, 151, 12, 179, 235, 106, 67, 216, 140, 166, 38, 197, 183, 12, 116, 154, 32, 171, 185, 38, 49, 104, 216, 62, 18, 172, 199, 180, 48, 146, 67, 141, 250, 64
  };
  const int *in1 = &data1[0];
    int data2[] = {
  254, 20, 15, 244, 230, 40, 76, 193, 33, 130, 117, 187, 23, 254, 232, 217, 244, 195, 126, 156, 185, 108, 126, 160, 12, 14, 222, 110, 22, 209, 11, 238, 178, 198, 120, 8, 228, 246, 134, 101, 106, 197, 94, 209, 7, 110, 118, 112, 161, 209, 4, 14, 14, 212, 16, 93, 99, 28, 6, 87, 80, 50, 125, 85
  const int *in2 = &data2[0];
  int out_data[64];
  int *out = &out_data[0];
  for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
    vint16mf4_t out = __riscv_vadd_vx_i16mf4 (data1, data2);
    in1 += Q_element;
    out += Q_element;
  }
  int golden[] = {
  455, 103, 153, 485, 298, 285, 205, 435, 269, 234, 345, 205, 69, 467, 423, 318, 415, 386, 329, 164, 377, 126, 358, 336, 167, 143, 369, 189, 149, 397, 128, 389, 190, 377, 355, 114, 295, 462, 274, 267, 144, 394, 277, 221, 123, 264, 150, 283, 346, 247, 53, 118, 230, 274, 34, 265, 298, 208, 54, 233, 147, 191, 375, 149
  };
  int fail = 0;
  for (int i = 0; i < 64; i++)
     if (golden0[i] != out0_data[i]) {
       printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
       fail++;
     }
  if (fail) {
    return 1;
  } else {
    return 0;
  }
}
