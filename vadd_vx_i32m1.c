/* { dg-do run } */
/* { dg-options "-march=rv64gcv -mabi=lp64d -O3 -fno-schedule-insns -fno-schedule-insns2" } */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "riscv_vector.h"
int main(){
    int data1[] = {
  125, 97, 28, 65, 205, 71, 8, 244, 235, 191, 159, 197, 96, 82, 162, 86, 201, 114, 82, 5, 170, 139, 91, 162, 204, 116, 146, 25, 194, 78, 234, 83, 136, 178, 230, 200, 116, 157, 63, 16, 108, 106, 194, 16, 167, 197, 71, 96, 98, 70, 183, 163, 49, 65, 233, 45, 122, 156, 110, 57, 195, 67, 207, 229
  };
  const int *in1 = &data1[0];
    int data2[] = {
  123, 41, 87, 96, 56, 146, 118, 214, 74, 65, 27, 120, 88, 148, 242, 66, 35, 153, 101, 156, 230, 18, 0, 70, 170, 15, 154, 87, 173, 199, 80, 136, 224, 36, 52, 46, 240, 82, 204, 170, 186, 231, 186, 67, 75, 53, 19, 242, 209, 29, 20, 221, 137, 225, 96, 143, 95, 121, 122, 118, 69, 116, 164, 180
  const int *in2 = &data2[0];
  int out_data[64];
  int *out = &out_data[0];
  for (int n = 64, Q_element = 4;n >= 0; n -= Q_element) {
    vint32m1_t out = __riscv_vadd_vx_i32m1 (data1, data2);
    in1 += Q_element;
    out += Q_element;
  }
  int golden[] = {
  248, 138, 115, 161, 261, 217, 126, 458, 309, 256, 186, 317, 184, 230, 404, 152, 236, 267, 183, 161, 400, 157, 91, 232, 374, 131, 300, 112, 367, 277, 314, 219, 360, 214, 282, 246, 356, 239, 267, 186, 294, 337, 380, 83, 242, 250, 90, 338, 307, 99, 203, 384, 186, 290, 329, 188, 217, 277, 232, 175, 264, 183, 371, 409
  };
  int fail = 0;
  for (int i = 0; i < 64; i++)
     if (golden0[i] != out0_data[i]) {
       printf ("idx=%d golden=%d out=%d\n", i, golden0[i], out0[i]);
       fail++;
     }
  if (fail) {
    return 1;
  } else {
    return 0;
  }
}
